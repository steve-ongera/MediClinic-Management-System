{% extends 'base/base.html'%}
{% block content %}
    <div class="container mt-4">
        <!-- Header -->
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>{{ title }}</h1>
            <a href="{% url 'doctor_list' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-left"></i> Back to List
            </a>
        </div>

        <!-- Messages -->
        {% if messages %}
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        {% endif %}

        <!-- Form -->
        <form method="post" enctype="multipart/form-data" novalidate>
            {% csrf_token %}
            
            <!-- Personal Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-user"></i> Personal Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.first_name.id_for_label }}" class="form-label">
                                {{ form.first_name.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.first_name }}
                            {% if form.first_name.errors %}
                                <div class="text-danger small">
                                    {% for error in form.first_name.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.last_name.id_for_label }}" class="form-label">
                                {{ form.last_name.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.last_name }}
                            {% if form.last_name.errors %}
                                <div class="text-danger small">
                                    {% for error in form.last_name.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.date_of_birth.id_for_label }}" class="form-label">
                                {{ form.date_of_birth.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.date_of_birth }}
                            {% if form.date_of_birth.errors %}
                                <div class="text-danger small">
                                    {% for error in form.date_of_birth.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.gender.id_for_label }}" class="form-label">
                                {{ form.gender.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.gender }}
                            {% if form.gender.errors %}
                                <div class="text-danger small">
                                    {% for error in form.gender.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.blood_type.id_for_label }}" class="form-label">
                                {{ form.blood_type.label }}
                            </label>
                            {{ form.blood_type }}
                            {% if form.blood_type.errors %}
                                <div class="text-danger small">
                                    {% for error in form.blood_type.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.id_number.id_for_label }}" class="form-label">
                                {{ form.id_number.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.id_number }}
                            {% if form.id_number.errors %}
                                <div class="text-danger small">
                                    {% for error in form.id_number.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.national_id.id_for_label }}" class="form-label">
                                {{ form.national_id.label }}
                            </label>
                            {{ form.national_id }}
                            {% if form.national_id.errors %}
                                <div class="text-danger small">
                                    {% for error in form.national_id.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.passport_number.id_for_label }}" class="form-label">
                                {{ form.passport_number.label }}
                            </label>
                            {{ form.passport_number }}
                            {% if form.passport_number.errors %}
                                <div class="text-danger small">
                                    {% for error in form.passport_number.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Contact Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-phone"></i> Contact Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.phone_number.id_for_label }}" class="form-label">
                                {{ form.phone_number.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.phone_number }}
                            {% if form.phone_number.errors %}
                                <div class="text-danger small">
                                    {% for error in form.phone_number.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.alternate_phone.id_for_label }}" class="form-label">
                                {{ form.alternate_phone.label }}
                            </label>
                            {{ form.alternate_phone }}
                            {% if form.alternate_phone.errors %}
                                <div class="text-danger small">
                                    {% for error in form.alternate_phone.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.email.id_for_label }}" class="form-label">
                                {{ form.email.label }}
                            </label>
                            {{ form.email }}
                            {% if form.email.errors %}
                                <div class="text-danger small">
                                    {% for error in form.email.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.emergency_contact.id_for_label }}" class="form-label">
                                {{ form.emergency_contact.label }}
                            </label>
                            {{ form.emergency_contact }}
                            {% if form.emergency_contact.errors %}
                                <div class="text-danger small">
                                    {% for error in form.emergency_contact.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.emergency_phone.id_for_label }}" class="form-label">
                                {{ form.emergency_phone.label }}
                            </label>
                            {{ form.emergency_phone }}
                            {% if form.emergency_phone.errors %}
                                <div class="text-danger small">
                                    {% for error in form.emergency_phone.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Address Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-map-marker-alt"></i> Address Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.address.id_for_label }}" class="form-label">
                                {{ form.address.label }}
                            </label>
                            {{ form.address }}
                            {% if form.address.errors %}
                                <div class="text-danger small">
                                    {% for error in form.address.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.city.id_for_label }}" class="form-label">
                                {{ form.city.label }}
                            </label>
                            {{ form.city }}
                            {% if form.city.errors %}
                                <div class="text-danger small">
                                    {% for error in form.city.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.state.id_for_label }}" class="form-label">
                                {{ form.state.label }}
                            </label>
                            {{ form.state }}
                            {% if form.state.errors %}
                                <div class="text-danger small">
                                    {% for error in form.state.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-4 mb-3">
                            <label for="{{ form.country.id_for_label }}" class="form-label">
                                {{ form.country.label }}
                            </label>
                            {{ form.country }}
                            {% if form.country.errors %}
                                <div class="text-danger small">
                                    {% for error in form.country.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.postal_code.id_for_label }}" class="form-label">
                                {{ form.postal_code.label }}
                            </label>
                            {{ form.postal_code }}
                            {% if form.postal_code.errors %}
                                <div class="text-danger small">
                                    {% for error in form.postal_code.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Professional Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-stethoscope"></i> Professional Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.specialization.id_for_label }}" class="form-label">
                                {{ form.specialization.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.specialization }}
                            {% if form.specialization.errors %}
                                <div class="text-danger small">
                                    {% for error in form.specialization.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.license_number.id_for_label }}" class="form-label">
                                {{ form.license_number.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.license_number }}
                            {% if form.license_number.errors %}
                                <div class="text-danger small">
                                    {% for error in form.license_number.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.license_expiry.id_for_label }}" class="form-label">
                                {{ form.license_expiry.label }}
                            </label>
                            {{ form.license_expiry }}
                            {% if form.license_expiry.errors %}
                                <div class="text-danger small">
                                    {% for error in form.license_expiry.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.years_of_experience.id_for_label }}" class="form-label">
                                {{ form.years_of_experience.label }} <span class="text-danger">*</span>
                            </label>
                            {{ form.years_of_experience }}
                            {% if form.years_of_experience.errors %}
                                <div class="text-danger small">
                                    {% for error in form.years_of_experience.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.qualifications.id_for_label }}" class="form-label">
                                {{ form.qualifications.label }}
                            </label>
                            {{ form.qualifications }}
                            {% if form.qualifications.errors %}
                                <div class="text-danger small">
                                    {% for error in form.qualifications.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12 mb-3">
                            <label for="{{ form.bio.id_for_label }}" class="form-label">
                                {{ form.bio.label }}
                            </label>
                            {{ form.bio }}
                            {% if form.bio.errors %}
                                <div class="text-danger small">
                                    {% for error in form.bio.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Hospital/Clinic Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-hospital"></i> Hospital/Clinic Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.department.id_for_label }}" class="form-label">
                                {{ form.department.label }}
                            </label>
                            {{ form.department }}
                            {% if form.department.errors %}
                                <div class="text-danger small">
                                    {% for error in form.department.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.position.id_for_label }}" class="form-label">
                                {{ form.position.label }}
                            </label>
                            {{ form.position }}
                            {% if form.position.errors %}
                                <div class="text-danger small">
                                    {% for error in form.position.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.joining_date.id_for_label }}" class="form-label">
                                {{ form.joining_date.label }}
                            </label>
                            {{ form.joining_date }}
                            {% if form.joining_date.errors %}
                                <div class="text-danger small">
                                    {% for error in form.joining_date.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="form-check">
                                {{ form.is_active }}
                                <label class="form-check-label" for="{{ form.is_active.id_for_label }}">
                                    {{ form.is_active.label }}
                                </label>
                            </div>
                            {% if form.is_active.errors %}
                                <div class="text-danger small">
                                    {% for error in form.is_active.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Medical Information -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-heartbeat"></i> Medical Information</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.allergies.id_for_label }}" class="form-label">
                                {{ form.allergies.label }}
                            </label>
                            {{ form.allergies }}
                            {% if form.allergies.errors %}
                                <div class="text-danger small">
                                    {% for error in form.allergies.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.chronic_conditions.id_for_label }}" class="form-label">
                                {{ form.chronic_conditions.label }}
                            </label>
                            {{ form.chronic_conditions }}
                            {% if form.chronic_conditions.errors %}
                                <div class="text-danger small">
                                    {% for error in form.chronic_conditions.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Availability -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-calendar"></i> Availability</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.working_days.id_for_label }}" class="form-label">
                                {{ form.working_days.label }}
                            </label>
                            {{ form.working_days }}
                            <div class="form-text">{{ form.working_days.help_text }}</div>
                            {% if form.working_days.errors %}
                                <div class="text-danger small">
                                    {% for error in form.working_days.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.working_hours.id_for_label }}" class="form-label">
                                {{ form.working_hours.label }}
                            </label>
                            {{ form.working_hours }}
                            <div class="form-text">{{ form.working_hours.help_text }}</div>
                            {% if form.working_hours.errors %}
                                <div class="text-danger small">
                                    {% for error in form.working_hours.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Files -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5><i class="fas fa-file"></i> Files</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.profile_picture.id_for_label }}" class="form-label">
                                {{ form.profile_picture.label }}
                            </label>
                            {{ form.profile_picture }}
                            {% if form.profile_picture.errors %}
                                <div class="text-danger small">
                                    {% for error in form.profile_picture.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                            {% if form.instance.profile_picture %}
                                <div class="mt-2">
                                    <small class="text-muted">Current: {{ form.instance.profile_picture.name }}</small>
                                </div>
                            {% endif %}
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="{{ form.signature.id_for_label }}" class="form-label">
                                {{ form.signature.label }}
                            </label>
                            {{ form.signature }}
                            {% if form.signature.errors %}
                                <div class="text-danger small">
                                    {% for error in form.signature.errors %}{{ error }}{% endfor %}
                                </div>
                            {% endif %}
                            {% if form.instance.signature %}
                                <div class="mt-2">
                                    <small class="text-muted">Current: {{ form.instance.signature.name }}</small>
                                </div>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Actions -->
            <div class="card">
                <div class="card-body">
                    <div class="d-flex justify-content-between">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> Save Doctor
                        </button>
                        <a href="{% url 'doctor_list' %}" class="btn btn-secondary">
                            <i class="fas fa-times"></i> Cancel
                        </a>
                    </div>
                </div>
            </div>
        </form>
    </div>
{% endblock %}